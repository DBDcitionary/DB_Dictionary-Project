@using PagedList;
@using PagedList.Mvc

@model WebApplication1.Models.qlist
@{
    ViewBag.Title = "Search";
}

<h2><strong>Search Results</strong></h2><br />

<div id="search">
    <p>
        <fieldset>
            <legend>Search Database Dictionary</legend>
            @using (@Html.BeginForm("search", "DB", FormMethod.Get))
            {
                <label>Search Criteria :</label><br />
                    @Html.RadioButton("searchby", "1")<text> Database </text>
                    @Html.RadioButton("searchby", "2")<text> Table </text>
                    @Html.RadioButton("searchby", "3")<text> Field </text>
                    @Html.RadioButton("searchby","4",true)<text>All</text>
                <br />
                <div id="searchtxtbox">
                    @Html.TextBox("search", null, new { placeholder = "Search............", style = "Height:34px;Width:240px;box-shadow: 1px 1px 8px #d9d9d9;padding-left:7px;border-top-left:5px" })
                </div>
                <div id="btnSearch">
                    <button type="submit" class="btn btn-primary" value="search"><span class="glyphicon glyphicon-search"></span></button>
                </div>
            }
        </fieldset>
    </p>
</div>

<table class="table table-striped">

    @if (@ViewBag.Mesage != null)
    {
        <tr>
            <td colspan="2">
                <div id="ErrorWarning">
                    <img src="~/fonts/alert.png"> Your search criteria return no matched results. Please try again.
                </div>
            </td>
        </tr>
    }
    else
    {
        <tr>
            <th>
                <strong>Name</strong>
            </th>
            <th>
                <strong>Description</strong>
            </th>
            @if (Model.tbllist != null)
            {
            <th>
                Database Name
            </th>
            }
            else if(Model.fldlist != null)
            {
                <th>
                    Database Name
                </th>
                <th>
                    Table Name
                </th>
                <th>
                    Data Type
                </th>
                <th>
                    Column Size
                </th>
            }
        </tr>
        if (Model.dblist != null)
        {
            foreach (var item in Model.dblist)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.DB_Name)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DB_Description)
                    </td>
                </tr>
            }

            if (Model.dblist != null)
            {
                @Html.PagedListPager(Model.dblist, page => Url.Action("search", new { page, searchby = Request.QueryString["searchby"], search = Request.QueryString["search"] }))
            }
        }

        if (Model.tbllist != null)
        {
            foreach (var item in Model.tbllist)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.TBL_Name)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.TBL_Description)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Database_Tbl.DB_Name)
                    </td>
                </tr>
            }
            if (Model.tbllist != null)
            {
                @Html.PagedListPager(Model.tbllist, page => Url.Action("search", new { page, searchby = Request.QueryString["searchby"], search = Request.QueryString["search"] }))
            }
        }

        if (Model.fldlist != null)
        {
            foreach (var item in Model.fldlist)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.Field_Name)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Field_Description)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DBName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.TableName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DataType)
                    </td>
                    <th>
                        @if (item.ColLength > 0)
                        {
                           @Html.DisplayFor(modelItem => item.ColLength).ToString();
                        }
                        else
                        {
                            if (item.ColLength == -1)
                            {
                                string max = "Max";
                                @Html.DisplayFor(modelItem => max).ToString();
                            }
                            else
                            {
                                @Html.DisplayFor(modelItem => item.Prec)
                            }
                        }
                    </th>
                </tr>
            }
            if (Model.fldlist != null)
            {
                @Html.PagedListPager(Model.fldlist, page => Url.Action("search", new { page, searchby = Request.QueryString["searchby"], search = Request.QueryString["search"] }))
            }
        }
    }
</table><br />